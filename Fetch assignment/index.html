<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Simple TODO App</title>
  <style>
    body { font-family: Arial; padding: 20px; }
    .todo { 
      padding: 10px; 
      border: 1px solid #ccc; 
      margin-bottom: 8px; 
      display: flex; 
      justify-content: space-between;
      align-items: center;
    }
    button { margin-left: 10px; }
    .empty { color: gray; font-style: italic; }
  </style>
</head>
<body>

  <h2>Todo App</h2>
  <div id="todo-list"></div>

  <script>
    const API_URL = "https://jsonplaceholder.typicode.com/todos";
    const STORAGE_KEY = "myTodos";

    // -------------------------------
    // 1) Fetch First 20 Todos & Store
    // -------------------------------
    async function fetchAndStoreTodos() {
      const res = await fetch(API_URL);
      const todos = await res.json();

      const first20 = todos.slice(0, 20);

      localStorage.setItem(STORAGE_KEY, JSON.stringify(first20));
      renderTodos();
    }

    // -------------------------------
    // 2) Get Todos from Local Storage
    // -------------------------------
    function getTodos() {
      return JSON.parse(localStorage.getItem(STORAGE_KEY)) || [];
    }

    // -------------------------------
    // 3) Render Todos on UI
    // -------------------------------
    function renderTodos() {
      const list = document.getElementById("todo-list");
      const todos = getTodos();

      list.innerHTML = "";

      if (todos.length === 0) {
        list.innerHTML = `<p class="empty">No Todos Available</p>`;
        return;
      }

      todos.forEach((todo) => {
        const div = document.createElement("div");
        div.className = "todo";

        div.innerHTML = `
          <span>
            <strong>${todo.title}</strong><br>
            Status: ${todo.completed ? "✅ Completed" : "❌ Pending"}
          </span>
          <span>
            <button onclick="toggleTodo(${todo.id})">Toggle</button>
            <button onclick="deleteTodo(${todo.id})">Delete</button>
          </span>
        `;

        list.appendChild(div);
      });
    }

    // -------------------------------
    // 4) Delete Todo
    // -------------------------------
    function deleteTodo(id) {
      let todos = getTodos();
      todos = todos.filter(todo => todo.id !== id);
      localStorage.setItem(STORAGE_KEY, JSON.stringify(todos));
      renderTodos();
    }

    // -------------------------------
    // 5) Toggle Completed Status
    // -------------------------------
    function toggleTodo(id) {
      let todos = getTodos();

      todos = todos.map(todo => {
        if (todo.id === id) {
          return { ...todo, completed: !todo.completed };
        }
        return todo;
      });

      localStorage.setItem(STORAGE_KEY, JSON.stringify(todos));
      renderTodos();
    }

    // -------------------------------
    // INITIAL CALL
    // -------------------------------
    if (!localStorage.getItem(STORAGE_KEY)) {
      fetchAndStoreTodos();
    } else {
      renderTodos();
    }
  </script>

</body>
</html>
